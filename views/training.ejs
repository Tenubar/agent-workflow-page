<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Training</title>
    <link rel="stylesheet" type ="text/css" href="css/styleHome.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
</head>
<body>

    <script>
        const username = "<%= username %>";
        const id = "<%= id %>";
    </script>

    <div class = "container">

        <aside>
            <div class ="top">
                <img class="logo" src ="./img/sokka_logo.png">
                <img class ="logo_h2" src ="./img/sokka_banner.png"> 
                <!-- <h2 class ="logo_h2"> Company </h2> -->
                
                <div class ="close" id ="close-btn">
                    <span class="material-symbols-outlined">keyboard_tab_rtl</span>
                </div>
            </div>

            <div class ="sidebar">
                <a href ="home">
                    <span class="material-symbols-outlined">grid_view</span>
                    <h3>Dashboard</h3>
                </a>
                <a href ="training" class ="active">
                    <span class="material-symbols-outlined">automation</span>
                    <h3>Training</h3>
                </a>
                <a href ="create">
                    <span class="material-symbols-outlined">edit</span>
                    <h3>Create</h3>
                </a>
                <a href ="content">
                    <span class="material-symbols-outlined">book_2</span>
                    <h3>Content Hub</h3>
                </a>
                <a href ="settings">
                    <span class="material-symbols-outlined">manage_accounts</span>
                    <h3>Settings</h3>
                </a>
                <a href ="logout">
                    <span class="material-symbols-outlined">logout</span>
                    <h3>Logout</h3>
                </a>
            </div>
        </aside>

    
    <div class ="training">

        <div class ="training-top">
        <h1>Training</h1>
        <small class = "text-muted">Train your AI on your business details to generate better content</small>
        </div>

        <div class ="training-middle">
        <table>
            <tbody>
                <tr>
                    <th class="space-a active" >Personal Context</th>
                    <th class="space-a">Brand Details</th>
                    <!-- <th class="space-a">Customer Avatars</th>
                    <th class="space-a">Personal Context</th> -->

                    <!-- <th class="space-a active">Personal Context</th>
                    <th class="space-a" >Business Information</th> -->
                    <!-- <th class="space-a">Brand Details</th>
                    <th class="space-a">Customer Avatars</th> -->

                </tr>
            </tbody>
        </table>
    

         <!-- Personal Context -->
        <form action = "#" method = "POST" class ="space-a0">
        <div class ="personal-context">
        <div class ="space-a0">
        
        <h1>Personal Context</h1>

        <h5>About youself</h5>
        <input type ="text" class = "personal-context-input" placeholder= "About yourself" id = "about-yourself">

        <h5>Your offers</h5>
        <input type ="text" class = "personal-context-input" placeholder= "Your offers" id = "about-offers">

        <h5>Your niche</h5>
        <input type ="text" class = "personal-context-input" placeholder= "Your niche" id = "about-niche">
        
        <div class = "submit-personal-context">
        <span class="material-symbols-outlined">save</span>
        <h3>Save</h3>
        </div>


        </form>
        <!-- <div class="dropdown">
        <div class ="dropdown-flex">
        <button class="dropdown-button">Select a style</button>
        <span class="material-symbols-outlined">keyboard_arrow_down</span>
        </div>
        </div>
        <ul class="dropdown-menu">
            <li><span class="dropdown-item">Formal</span></li>
            <li><span class="dropdown-item">Casual</span></li>
            <li><span class="dropdown-item">Direct</span></li>
            <li><span class="dropdown-item">Storytelling</span></li>
        </ul>

        <h5>Industry Expertice</h5>
        <textarea rows ="3" placeholder="Describe your experience and expertise in your industry"></textarea>

        <h5>Content Preferences</h5>

        <form>
        <label>
            <input type="checkbox" name="fruits" value="industry"> Use industry jargon
        </label><br>
    
        <label>
            <input type="checkbox" name="fruits" value="banana"> Include data and statistics
        </label><br>
    
        <label>
            <input type="checkbox" name="fruits" value="orange"> Use case studies and examples
        </label><br>
    
        <label>
            <input type="checkbox" name="fruits" value="grape"> Include personal anecdotes
        </label><br>
    
        <br><br>
    
        </form>

        <h5>Writing Style Examples</h5>
        <textarea rows ="3" placeholder="Paste example of content that matches your preferred style"></textarea>
    
        <h5>Topics to Avoid</h5>
        <textarea rows ="3" placeholder="List any topics or approaches you want to avoid"></textarea>
        <input type ="submit" class = "btn" value ="Generate Writing Profile"> -->
        </div>
        </div>


        <!--Business Information -->
        <form action = "#" method = "POST" class ="space-a1">

        <h1>Brand Details</h1>

        <h5>Business Name</h5>
        <div class = "business-info-flex">
        <input type ="text" class ="business" placeholder="Enter your business here" id ="about-business">
        </div>

        <h5> Website</h5>
        <div class = "business-info-flex">
        <input type ="text" class ="website" placeholder = "https://example.com" id ="about-website">
        <input type ="submit" class = "btn" value ="Analyze Website">
        </div>
        
        <div class = "submit-personal-context-2">
            <span class="material-symbols-outlined">save</span>
            <h3>Save</h3>
        </div>

        </form>


        <script>

        getTrainingData();

            // const submitPersonalContext = document.querySelector('.submit-personal-context');
            const submitPersonalContext = document.querySelector('.submit-personal-context');
            const submitPersonalContext2 = document.querySelector('.submit-personal-context-2');

        
            // Get Training Info
            function getTrainingData(){
            const userId = id; 

            // Fetch the user's trainingInfo data
            fetch(`/api/personal-context/${userId}`, {
                method: 'GET',
                headers: { 'Content-Type': 'application/json' }
            })
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! Status: ${response.status}`);
                    }
                    return response.json();
                })
                .then(data => {
                    console.log('Data successfully fetched:', data);

                    // Extract values from the response data
                    const aboutYourself = document.querySelector('#about-yourself');
                    const yourOffers = document.querySelector('#about-offers');
                    const yourNiche = document.querySelector('#about-niche');
                    const aboutBusiness = document.querySelector('#about-business');
                    const aboutWebsite = document.querySelector('#about-website');

                    // Populate the input fields with the fetched data
                    if (data.trainingInfo) {
                        aboutYourself.value = data.trainingInfo[0]?.yourself || '';
                        yourOffers.value = data.trainingInfo[0]?.offer || '';
                        yourNiche.value = data.trainingInfo[0]?.niche || '';
                        aboutBusiness.value = data.trainingInfo[0]?.business || '';
                        aboutWebsite.value = data.trainingInfo[0]?.website || '';
                    }
                })
                .catch(err => {
                    console.error('Error fetching data:', err);
                });
                }


                // Post new training info
                function submitTrainingData(){
                // Change the color and disable further clicks
                submitPersonalContext.style.backgroundColor = "gray"; // Update to the desired "disabled" color
                submitPersonalContext.style.cursor = "not-allowed";
                submitPersonalContext.style.pointerEvents = "none"; // Disables further clicks

                // Collect the values from the input fields
                const aboutYourself = document.querySelector('#about-yourself').value;
                const yourOffers = document.querySelector('#about-offers').value;
                const yourNiche = document.querySelector('#about-niche').value;
                const aboutBusiness = document.querySelector('#about-business').value;
                const aboutWebsite = document.querySelector('#about-website').value;
                const userId = id; 


                const formData = {
                    yourself: aboutYourself,
                    offer: yourOffers,
                    niche: yourNiche,
                    business: aboutBusiness,
                    website: aboutWebsite
                };

                fetch(`/api/personal-context/${userId}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(formData)
                })
                .then(response => response.json())
                .then(data => {
                    console.log('Data successfully submitted:', data);
                    // Re-enable the button after the response
                    submitPersonalContext.style.backgroundColor = ""; // Reset to the original color
                    submitPersonalContext.style.cursor = "pointer";
                    submitPersonalContext.style.pointerEvents = "auto"; // Allow clicks again
                })
                .catch(err => {
                    console.error('Error submitting data:', err);
                    // Re-enable the button even if there's an error
                    submitPersonalContext.style.backgroundColor = ""; // Reset to the original color
                    submitPersonalContext.style.cursor = "pointer";
                    submitPersonalContext.style.pointerEvents = "auto"; // Allow clicks again
                });
                }
            
            
                submitPersonalContext.addEventListener('click', submitTrainingData);
                submitPersonalContext2.addEventListener('click', submitTrainingData);

        </script>


        <!-- Brand Details -->
        <!-- <div class ="brandDetails">
        <form action = "#" method = "POST" class ="space-a1">
        <h1>Brand Details</h1>
        <h5> Content Analysis </h5>
        <p>Upload Examples of your existing content to help us understand and replicate your brand voice</p> -->
    
<!-- 
        <div class="upload-file">
            <input type="file" name="file" id="fileInput" required />
            <label for="fileInput">
              <span class="material-symbols-outlined">upload</span>
              <h4>Drop Files Here or Click to Upload</h4>
              <small class="text-muted">Supported formats: TXT, MD, DOC, DOCX</small>
            </label>
          </div> -->

        <!-- <h5>Mission Statement</h5>
        <textarea rows ="3" class="mission-textarea" placeholder = "What drives your business?"></textarea>

        <h5>Core Values</h5>
        <textarea rows ="3" class="mission-textarea" placeholder = "One value per line (e.g., Innovation, Integrity, Excellence)"></textarea>

        <h5>Brand Story</h5>
        <textarea rows ="3" class="mission-textarea" placeholder = "Share your brand's journey and story"></textarea>

        <h5>Visual Identity</h5>
        <p class ="text-muted">Brand Colors (HEX codes)</p>   
        <input type ="text" placeholder = "#000000, #FFFFFF, etc.">

        <h5>Typography</h5>
        <input type ="text" placeholder = "#000000, #FFFFFF, etc.">

        <h5>Key Messages</h5>
        <textarea rows ="3" class="mission-textarea" placeholder = "Core messages that define your brand"></textarea>

        </form>
        </div> -->

        

        <!-- Customer Avatars -->
        <!-- <div class = "customer-avatar">
        <div class ="space-a2">
        <h1>Customer Avatars</h1>
        <div id ="add-avatar">
        <span class="material-symbols-outlined">add</span>
        <input type ="submit" class = "btn" value ="Add Avatar">
        </div>

        <div id = "form-container-avatar">

        </div>

    </div>
        </div> -->

    </div>
        </form>

    </div>
</div>
</div>

<script src="js/jquery-3.7.1.min.js"></script>
<script type = "text/javascript" src ="js/mainTraining.js"></script>

</body>
</html>